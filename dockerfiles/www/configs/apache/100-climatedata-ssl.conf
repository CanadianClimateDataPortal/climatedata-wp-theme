# HTTPS configuration for the main website.
#
# This configuration requires SSL certificate files. Those files are not included in the Docker image, so they must
# be mounted in the correct directory (see the configuration below) when running the container.

# For development, we want to allow to run this image as a non-HTTPS website. The next <IfFile> is a simple validation
# to prevent loading the HTTPS configuration (and generating an error) if no SSL certificates were mounted.
# Note that it wouldn't have been possible to use the `APP_NO_HTTPS` environment variable at this stage of the
# configuration.
<IfFile /etc/ssl/certs/cert.pem>
	<VirtualHost *:443>
		ServerAdmin webmaster@localhost
		DocumentRoot /var/www/html

		CustomLog ${APACHE_LOG_DIR}/access.log combined

		SSLEngine on

		SSLCertificateFile /etc/ssl/certs/cert.pem
		SSLCertificateKeyFile /etc/ssl/certs/privkey.pem
		SSLCertificateChainFile /etc/ssl/certs/fullchain.pem

		<FilesMatch "\.(?:php)$">
			SSLOptions +StdEnvVars
		</FilesMatch>

		<Directory "/var/www/html">
			Options Indexes FollowSymLinks
			AllowOverride All
			Require all granted
		</Directory>

	</VirtualHost>
</IfFile>
